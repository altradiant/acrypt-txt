## Blowfish

### Введение

Blowfish — это ~~иглобрюхая рыба~~ симметричный блочный шифр, разработанный Брюсом Шнайером в 1993 году. Он предназначен для замены устаревших алгоритмов, таких как DES, и стал популярным благодаря своей высокой скорости и гибкости в выборе длины ключа. Blowfish шифрует данные блоками по 64 бита, используя ключи длиной от 32 до 448 бит.

Хотя он не стал официальным стандартом, как это сделал AES, Blowfish остается популярным благодаря своей скорости и эффективности.

### Основные характеристики

- **Тип шифра**: Симметричный блочный шифр.
- **Длина блока**: 64 бита.
- **Длина ключа**: От 32 до 448 бит (всегда кратна 8 битам).
- **Количество раундов**: 16.
- **Используемые операции**: Подстановки (S-блоки), перестановки, XOR с ключом.

**В программной реализации будет использоваться ключ длиной 448 бит.**

Не забываем, что:

Первоначальный ключ в программных реализациях преобразуется по хэш-функции; выходной результат шифрования кодируется с помощью base64; соответственно, при расшифровке сначала происходит раскодировка base64.

IV и nonce также крепятся к началу шифротекста (IV или nonce в зависимости от режима: CBC или CTR).

*Blowfish похож на DES, но имеет более длинный ключ и большее количество раундов, что делает его более безопасным.*

## Режим CBC (Cipher Block Chaining)

### Описание

В режиме CBC каждый блок открытого текста XOR-ится с предыдущим блоком шифротекста перед шифрованием. Это обеспечивает зависимость между блоками, что делает шифрование более безопасным, так как одинаковые блоки открытого текста будут давать разные блоки шифротекста.

### Принцип работы

1. **Инициализация**: Используется случайный вектор инициализации (IV), который XOR-ится с первым блоком открытого текста.
2. **Шифрование**:
   - Первый блок открытого текста XOR-ится с IV, затем шифруется с использованием Blowfish.
   - Каждый последующий блок открытого текста XOR-ится с предыдущим блоком шифротекста перед шифрованием.
3. **Расшифрование**:
   - Каждый блок шифротекста расшифровывается с использованием Blowfish.
   - Результат XOR-ится с предыдущим блоком шифротекста для получения открытого текста.

## Режим CTR (Counter)

### Описание

В режиме CTR используется счетчик (counter), который шифруется с использованием Blowfish, а затем результат XOR-ится с блоком открытого текста. Этот режим позволяет обрабатывать блоки независимо, что делает его более эффективным для параллельной обработки.

### Принцип работы

1. **Инициализация**: Используется счетчик (counter), который увеличивается для каждого блока.
2. **Шифрование**:
   - Счетчик шифруется с использованием Blowfish.
   - Результат шифрования XOR-ится с блоком открытого текста для получения шифротекста.
3. **Расшифрование**:
   - Тот же процесс используется для расшифрования, так как шифрование и расшифрование в режиме CTR идентичны.

На этот раздел отведено два задания.

*AES и Blowfish:*

- Blowfish остается популярным благодаря своей простоте и скорости на 32-битных процессорах, но он уступает AES по производительности и безопасности на современных системах.

- AES является более современным и безопасным алгоритмом, который активно используется в правительственных и коммерческих системах. Его аппаратная поддержка и высокая производительность делают его предпочтительным выбором для большинства приложений.